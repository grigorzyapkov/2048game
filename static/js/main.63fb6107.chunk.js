(this.webpackJsonp2048game=this.webpackJsonp2048game||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(8),c=n.n(i),a=(n(13),n(14),n(3)),s=n(4),u=n(2),l=[0,1,2,3],d=function(e,t){var n,r;return null===e&&null===t||(e&&(null===(n=Object.keys(e))||void 0===n?void 0:n.length))===(t&&(null===(r=Object.keys(t))||void 0===r?void 0:r.length))&&Object.keys(e).every((function(n){return e[n]===t[n]}))},f=function(e,t){return v(e,(function(e){return e.positionY}),(function(e,t){return e.positionY=t}),t)},j=function(e,t){return v(e,(function(e){return e.positionX}),(function(e,t){return e.positionX=t}),t)},v=function(e,t,n,r){if(0===e.length)return[];var o=JSON.parse(JSON.stringify(e));o.sort((function(e,n){return t(e)-t(n)}));for(var i="left"===r?0:4-o.length,c=0;c<o.length;c++)n(o[c],i+c);"left"===r&&o.reverse();for(var a=o.length-1;a>=1;)if(o[a].value!==o[a-1].value||2048===o[a].value)a--;else{for(var s=0;s<=a-1;s++){var u="right"===r?1:-1;n(o[s],t(o[s])+u)}a-=2}return o},b=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=[];e>0;)t=[].concat(Object(s.a)(t),[h(t)]),e--;return t},h=function(e){var t=function(e){return[Math.floor(e/4),e%4]};Math.floor(16*Math.random());for(var n=Math.floor(16*Math.random()),r=t(n);O.apply(void 0,[e].concat(Object(s.a)(r)));)r=t(n=15===n?0:n+1);var o=Math.random()<=.2?4:2;return{id:x(e),value:o,type:"new",positionX:r[0],positionY:r[1]}},O=function(e,t,n){return e.some((function(e){return e.positionX===t&&e.positionY===n}))},m=function(e,t){return e.filter((function(e){return e.positionX===t}))},p=function(e,t){return e.filter((function(e){return e.positionY===t}))},x=function(e){return g(e)+1},g=function(e){return Math.max.apply(Math,[0].concat(Object(s.a)(e.map((function(e){return e.id})))))},y={ArrowUp:function(e){return l.map((function(t){return j(p(e,t),"left")})).flat()},ArrowDown:function(e){return l.map((function(t){return j(p(e,t),"right")})).flat()},ArrowRight:function(e){return l.map((function(t){return f(m(e,t),"right")})).flat()},ArrowLeft:function(e){return l.map((function(t){return f(m(e,t),"left")})).flat()}},w=420,S=520,N=73,E=97,M=121,C=(n(15),n(0)),k=Object(r.memo)((function(e){return Object(C.jsx)("div",{className:"tile tile-".concat(e.value),style:{transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)")},children:Object(C.jsx)("div",{className:"tileInner ".concat(e.type),children:e.value})})})),A=(n(17),function(e){return Object(C.jsx)("div",{children:e.tiles.map((function(t){return Object(C.jsx)(k,{value:t.value,type:t.type,x:t.positionY*e.factor,y:t.positionX*e.factor},t.id)}))})}),I=function(e){var t=Object(r.useState)(P()),n=Object(a.a)(t,2),o=n[0],i=n[1];Object(r.useEffect)((function(){var e=function(){i(P())};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var c=e.tiles.sort((function(e,t){return e.id-t.id}));return Object(C.jsx)("div",{className:"tileContainer",children:Object(C.jsx)(A,{tiles:c,factor:o})})},P=function(){return window.innerWidth<=w?N:window.innerWidth<=S?E:M},R=(n(18),n(19),function(e){return Object(C.jsx)("button",{id:e.id,className:"appButton",onClick:e.onClick,children:e.children})}),T={WIN:{message:"Congratulations! You Win!",buttonText:"Play again",containerClass:"gameResultWin"},LOSE:{message:"Game Over!",buttonText:"Try again",containerClass:"gameResultLose"}},L=function(e){var t=ue().dispatch,n=e.isWon?T.WIN:T.LOSE,r=n.message,o=n.buttonText,i=n.containerClass;return Object(C.jsxs)("div",{className:"gameResult ".concat(i),children:[Object(C.jsx)("p",{children:r}),Object(C.jsx)(R,{onClick:function(e){return t({type:"restart"})},children:o})]})},W=function(e){return function(e){return e.some((function(e){return 2048===e.value}))}(e)?"WIN":function(e){if(e.length<16)return!1;for(var t=function(e,t,n){return e.some((function(e){return t.some((function(t){return n(e)===n(t)&&e.value===t.value}))}))},n=0;n<3;n++)if(t(m(e,n),m(e,n+1),(function(e){return e.positionY}))||t(p(e,n),p(e,n+1),(function(e){return e.positionX})))return!1;return!0}(e)?"GAME_OVER":"IN_PROGRESS"},Y=function(e){var t=W(e.tiles);return Object(C.jsxs)("div",{className:"boardContainer",children:["IN_PROGRESS"!==t&&Object(C.jsx)(L,{isWon:"WIN"===t}),Object(C.jsx)(G,{}),Object(C.jsx)(I,{tiles:e.tiles})]})},G=function(){var e=Array.from(Array(4).keys()).map((function(e){var t=Array.from(Array(4).keys()).map((function(e){return Object(C.jsx)("div",{className:"cell"},e)}));return Object(C.jsx)("div",{className:"row",children:t},e)}));return Object(C.jsx)("div",{className:"gridContainer",children:e})},J=function(){var e=ue().gameState,t=Object(r.useReducer)(X,B()),n=Object(a.a)(t,2),o=n[0],i=n[1];return Object(r.useEffect)((function(){i({type:"addMove",payload:e})}),[e]),Object(r.useEffect)((function(){o.moves.length<2||o.loading||(i({type:"startMove"}),setTimeout((function(){i({type:"endMove"})}),100))}),[o]),Object(C.jsx)(Y,{tiles:o.tiles})};function X(e,t){switch(t.type){case"addMove":return!t.payload.lastMove||0===e.tiles.length?B(t.payload):Object(u.a)(Object(u.a)({},e),{},{moves:[].concat(Object(s.a)(e.moves),[t.payload])});case"startMove":var n=e.moves[0],r=e.moves[1],o=y[r.lastMove](n.tiles);return Object(u.a)(Object(u.a)({},e),{},{loading:!0,tiles:o});case"endMove":var i=e.moves[1];return{moves:e.moves.slice(1),loading:!1,tiles:i.tiles};default:throw new Error("Unhandled action: ".concat(t))}}var B=function(e){return e?{moves:[e],loading:!1,tiles:e.tiles}:{moves:[],loading:!1,tiles:[]}},U=(n(20),"2048game"),D=function(e,t){return"function"===typeof t?t(e):t},F=function(e,t){try{var n=JSON.parse(window.localStorage.getItem(U)),r=null===n||void 0===n?void 0:n[e];return null!==r&&void 0!==r?r:t}catch(o){return console.log(o),t}};var _=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:D,o=Object(r.useReducer)(n,F(e,t)),i=Object(a.a)(o,2),c=i[0],s=i[1];return Object(r.useEffect)((function(){var t=JSON.parse(window.localStorage.getItem(U))||{};t[e]=c,window.localStorage.setItem(U,JSON.stringify(t))}),[c,e]),[c,s]},z=(n(21),function(e){return Object(C.jsxs)("div",{className:"scoreBox",children:[Object(C.jsx)("span",{className:"title",children:e.title}),Object(C.jsx)("span",{className:"score",children:e.score})]})}),H=(n(22),function(){var e=ue().gameState,t=_("scores",V(),K),n=Object(a.a)(t,2),o=n[0],i=n[1];return Object(r.useEffect)((function(){i({type:"change",payload:e.tiles})}),[e.tiles,i]),Object(r.useEffect)((function(){if(o.newPoints>0){var e=document.getElementById("additionScore");e.innerText="+".concat(o.newPoints);var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)}}),[o]),Object(C.jsxs)("div",{className:"scoresContainer",children:[Object(C.jsxs)("div",{style:{position:"relative"},children:[Object(C.jsx)(z,{title:"SCORE",score:o.score}),Object(C.jsx)("div",{className:"addScore",id:"additionScore"})]}),Object(C.jsx)(z,{title:"BEST",score:o.bestScore})]})}),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{score:0,newPoints:0,bestScore:0,tiles:e}},q=function(e,t){return e.some((function(e){return e.id===t.id}))},K=function(e,t){switch(t.type){case"change":var n=t.payload;if(e.tiles.length===n.length&&e.tiles.every((function(e){return q(n,e)})))return e;if(2===n.length&&[1,2].every((function(e){return n.find((function(t){return t.id===e}))}))&&!e.tiles.every((function(e){return q(n,e)})))return Object(u.a)(Object(u.a)({},V(n)),{},{bestScore:e.bestScore});if(e.tiles.every((function(e){return q(n,e)}))&&n.length===e.tiles.length+1)return Object(u.a)(Object(u.a)({},e),{},{tiles:n,newPoints:0});var r=g(n),o=n.reduce((function(t,n){return t+(n.id===r||q(e.tiles,n)?0:n.value)}),0),i=e.score+o,c=Math.max(i,e.bestScore);return{tiles:n,newPoints:o,score:i,bestScore:c};default:throw new Error("Unhandled action type: ".concat(t.type))}},Q=(n(23),function(){return Object(C.jsx)("span",{className:"gameTitle",children:"2048"})}),Z=function(){return Object(C.jsxs)("div",{children:[Object(C.jsxs)("span",{children:["Join the numbers to get ",Object(C.jsx)("b",{children:"2048"}),"!"]}),Object(C.jsx)("br",{}),Object(C.jsx)("a",{href:"#howToPlaySection",children:"How to play \u2192"})]})},$=function(){var e=ue().dispatch;return Object(C.jsxs)("div",{className:"header",children:[Object(C.jsxs)("div",{className:"gameIntro",children:[Object(C.jsx)(Q,{}),Object(C.jsx)(Z,{})]}),Object(C.jsxs)("div",{className:"actions",children:[Object(C.jsx)(H,{}),Object(C.jsx)(R,{id:"restartGameBtn",onClick:function(t){return e({type:"restart"})},children:"New Game"})]})]})},ee=function(e){return Object(C.jsxs)("div",{id:e.id,children:[Object(C.jsx)("h4",{children:e.title}),e.children,e.bottomSeparator?Object(C.jsx)("hr",{}):null]})},te=function(e){return Object(C.jsx)(ee,{id:"howToPlaySection",title:"HOW TO PLAY",bottomSeparator:e.bottomSeparator,children:Object(C.jsxs)("p",{children:["Use your arrow keys to move the numbers. The same numbers will be merged into one when they touch. After each move, a new number (",Object(C.jsx)("strong",{children:"2"})," or ",Object(C.jsx)("strong",{children:"4"}),") is generated at a random empty position. Merge the numbers and build a 2048 number to"," ",Object(C.jsx)("strong",{children:"WIN"})," the game!"]})})},ne=function(e){return Object(C.jsx)(ee,{title:"LEARN MORE",bottomSeparator:e.bottomSeparator,children:Object(C.jsxs)("p",{children:["This app is inspired by"," ",Object(C.jsx)("a",{href:"https://play2048.co/",children:"https://play2048.co/"}),". If you want to learn more about the project tech stack or see the code, visit the\xa0",Object(C.jsx)("a",{href:"https://github.com/grigorzyapkov/2048game",target:"_blank",rel:"noreferrer",children:"Github repository"}),"."]})})},re=function(){return Object(C.jsxs)("div",{children:[Object(C.jsx)(te,{}),Object(C.jsx)("hr",{}),Object(C.jsx)(ne,{})]})},oe=o.a.createContext(null),ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return{tiles:b(e),lastMove:null}};function ce(e,t){switch(t.type){case"restart":return ie();case"move":var n=(0,y[t.payload])(e.tiles);return r=e.tiles,o=n,r.every((function(e){return o.some((function(t){return d(e,t)}))}))?e:(n=function(e){var t=x(e),n={};return e.forEach((function(e){var r="".concat(e.positionX).concat(e.positionY);if(n[r]){var o=2*e.value;n[r]=Object(u.a)(Object(u.a)({},e),{},{id:t++,value:o,type:"merged"})}else n[r]=e})),Object.values(n)}(n),{tiles:[].concat(Object(s.a)(n),[h(n)]),lastMove:t.payload});default:throw new Error("Unhandled action: ".concat(t))}var r,o}var ae=function(e){var t=_("game",ie(),ce),n=Object(a.a)(t,2),o=n[0],i=n[1];return Object(r.useEffect)((function(){var e=function(e){e.preventDefault(),["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e.key)&&i({type:"move",payload:e.key})};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[i]),Object(C.jsx)(oe.Provider,{value:{gameState:o,dispatch:i},children:e.children})},se=function(){return Object(C.jsx)(ae,{children:Object(C.jsxs)("div",{className:"container",children:[Object(C.jsxs)("div",{className:"gameContainer",children:[Object(C.jsx)($,{}),Object(C.jsx)(J,{})]}),Object(C.jsx)(re,{})]})})};function ue(){var e=Object(r.useContext)(oe);if(void 0===e)throw new Error("useGameContext must be used within a GameContextProvider");return e}var le=function(){return Object(C.jsx)("div",{className:"App",children:Object(C.jsx)("main",{children:Object(C.jsx)(se,{})})})},de=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,25)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),o(e),i(e),c(e)}))};c.a.render(Object(C.jsx)(o.a.StrictMode,{children:Object(C.jsx)(le,{})}),document.getElementById("root")),de()}],[[24,1,2]]]);
//# sourceMappingURL=main.63fb6107.chunk.js.map