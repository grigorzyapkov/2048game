{"version":3,"sources":["utils/gameUtils.ts","constants/constants.ts","components/Tiles/Tile.tsx","components/Tiles/TilesList.tsx","components/Button/Button.tsx","components/Board/GameResult.tsx","components/Board/Board.tsx","components/Board/BoardProvider.tsx","components/Board/BoardContainer.tsx","hooks/useLocalStorage.ts","components/ScoreBox/ScoreBox.tsx","components/ScoresContainer/ScoresContainer.tsx","components/GameHeader/GameHeader.tsx","components/GameFooter/GameFooter.tsx","components/Game/Game.tsx","components/App/App.tsx","reportWebVitals.ts","index.tsx"],"names":["INDICES","areTilesEqual","t1","t2","Object","keys","length","every","p","shiftHorizontally","line","direction","shift","v","positionY","position","shiftVertically","positionX","getColumn","setColumn","result","JSON","parse","stringify","sort","v1","v2","startPosition","i","reverse","value","j","generateBoard","tilesCount","tiles","createRandomTile","getCoordinates","Math","floor","random","coordinates","isExists","id","getNextId","type","some","x","getRow","row","filter","column","getMaxId","max","apply","map","MOVES_MAP","flat","ScreenSizeBreakpoint","TilesScreenTransformFactor","KEYBOARD_ARROW_TO_DIRECTION_MAP","ArrowUp","ArrowDown","ArrowRight","ArrowLeft","Tile","memo","props","className","style","transform","y","TilesList","factor","TileContainer","useState","calcFactor","setFactor","useEffect","handleResize","window","addEventListener","removeEventListener","sortedTiles","innerWidth","Button","onClick","children","DATA","message","buttonText","containerClass","GameResult","dispatch","useGameContext","isWon","WIN","LOSE","_","getGameStatus","tile","isGameWon","movePossible","arr1","arr2","getCoordinate","isGameOver","BoardGrid","grid","Array","from","rowId","columns","colId","Board","status","BoardProvider","gameState","useReducer","boardReducer","initState","boardState","payload","moves","loading","setTimeout","state","action","lastMove","currGameState","nextGameState","slice","Error","startClientX","startClientY","BoardContainer","handleTouchStart","event","touches","startTouch","clientX","clientY","handleTouchEnd","endTouch","changedTouches","endClientX","endClientY","xDiff","yDiff","abs","boardContainer","document","getElementById","GAME_ID","useStateReducer","prevState","newState","getInitialValue","key","defaultValue","localStorage","getItem","error","console","log","useGameLocalStorage","reducer","setItem","ScoreBox","title","score","ScoresContainer","stateReducer","newPoints","oldAddScore","innerText","newAddScore","cloneNode","parentNode","replaceChild","bestScore","containsTile","t","find","lastGeneratedTileId","reduce","acc","curr","GameTitle","GameDescription","href","GameHeader","Section","bottomSeparator","GameRules","LearnMore","target","rel","GameFooter","GameContext","React","createContext","gameReducer","move","b1","b2","values","forEach","merge","GameProvider","handleKeyPress","e","preventDefault","Provider","Game","context","useContext","undefined","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.6c476f25.chunk.js","sourcesContent":["import { Value, Tile, Direction } from \"../components/Interfaces\";\r\n\r\nconst INDICES = [0, 1, 2, 3];\r\n\r\nexport const areEqual = (b1: Tile[], b2: Tile[]) => {\r\n  return b1.every((x) => b2.some((y) => areTilesEqual(x, y)));\r\n};\r\n\r\nexport const areTilesEqual = (t1: Tile, t2: Tile): boolean => {\r\n  return (\r\n    (t1 === null && t2 === null) ||\r\n    ((t1 && Object.keys(t1)?.length) === (t2 && Object.keys(t2)?.length) &&\r\n      Object.keys(t1).every((p) => t1[p] === t2[p]))\r\n  );\r\n};\r\n\r\nexport const isGameWon = (tiles: Tile[]) => {\r\n  return tiles.some((tile) => tile.value === 2048);\r\n};\r\n\r\nexport const isGameOver = (tiles: Tile[]) => {\r\n  if (tiles.length < 16) {\r\n    return false;\r\n  }\r\n\r\n  const movePossible = (\r\n    arr1: Tile[],\r\n    arr2: Tile[],\r\n    getCoordinate: (x: Tile) => number\r\n  ) => {\r\n    return arr1.some((x) =>\r\n      arr2.some(\r\n        (y) => getCoordinate(x) === getCoordinate(y) && x.value === y.value\r\n      )\r\n    );\r\n  };\r\n\r\n  for (let i = 0; i < 3; i++) {\r\n    if (\r\n      movePossible(\r\n        getRow(tiles, i),\r\n        getRow(tiles, i + 1),\r\n        (x: Tile) => x.positionY\r\n      ) ||\r\n      movePossible(\r\n        getColumn(tiles, i),\r\n        getColumn(tiles, i + 1),\r\n        (x: Tile) => x.positionX\r\n      )\r\n    ) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nexport const merge = (tiles: Tile[]): Tile[] => {\r\n  let id = getNextId(tiles);\r\n  let values: { [key: string]: Tile } = {};\r\n\r\n  tiles.forEach((v) => {\r\n    const key = `${v.positionX}${v.positionY}`;\r\n    if (values[key]) {\r\n      const value = (v.value * 2) as Value;\r\n      values[key] = { ...v, id: id++, value, type: \"merged\" };\r\n    } else {\r\n      values[key] = v;\r\n    }\r\n  });\r\n\r\n  return Object.values(values);\r\n};\r\n\r\nexport const moveRight = (tiles: Tile[]): Tile[] => {\r\n  return INDICES.map((i) =>\r\n    shiftHorizontally(getRow(tiles, i), \"right\")\r\n  ).flat();\r\n};\r\n\r\nexport const moveLeft = (tiles: Tile[]): Tile[] => {\r\n  return INDICES.map((i) => shiftHorizontally(getRow(tiles, i), \"left\")).flat();\r\n};\r\n\r\nexport const moveUp = (tiles: Tile[]): Tile[] => {\r\n  return INDICES.map((i) =>\r\n    shiftVertically(getColumn(tiles, i), \"left\")\r\n  ).flat();\r\n};\r\n\r\nexport const moveDown = (tiles: Tile[]): Tile[] => {\r\n  return INDICES.map((i) =>\r\n    shiftVertically(getColumn(tiles, i), \"right\")\r\n  ).flat();\r\n};\r\n\r\nconst shiftHorizontally = (line: Tile[], direction: Direction): Tile[] => {\r\n  return shift(\r\n    line,\r\n    (v: Tile) => v.positionY,\r\n    (v: Tile, position: number) => (v.positionY = position),\r\n    direction\r\n  );\r\n};\r\n\r\nconst shiftVertically = (line: Tile[], direction: Direction): Tile[] => {\r\n  return shift(\r\n    line,\r\n    (v: Tile) => v.positionX,\r\n    (v: Tile, position: number) => (v.positionX = position),\r\n    direction\r\n  );\r\n};\r\n\r\nconst shift = (\r\n  line: Tile[],\r\n  getColumn: (v: Tile) => number,\r\n  setColumn: (v: Tile, position: number) => void,\r\n  direction: Direction\r\n): Tile[] => {\r\n  if (line.length === 0) {\r\n    return [];\r\n  }\r\n  let result: Tile[] = JSON.parse(JSON.stringify(line));\r\n  result.sort((v1, v2) => getColumn(v1) - getColumn(v2));\r\n\r\n  const startPosition = direction === \"left\" ? 0 : 4 - result.length;\r\n  for (let i = 0; i < result.length; i++) {\r\n    setColumn(result[i], startPosition + i);\r\n  }\r\n\r\n  direction === \"left\" && result.reverse();\r\n  let i = result.length - 1;\r\n  while (i >= 1) {\r\n    if (result[i].value === result[i - 1].value && result[i].value !== 2048) {\r\n      for (let j = 0; j <= i - 1; j++) {\r\n        const shift = direction === \"right\" ? 1 : -1;\r\n        setColumn(result[j], getColumn(result[j]) + shift);\r\n      }\r\n      i -= 2;\r\n      continue;\r\n    }\r\n\r\n    i--;\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport const generateBoard = (tilesCount: number = 2): Tile[] => {\r\n  let tiles = [];\r\n  while (tilesCount > 0) {\r\n    tiles = [...tiles, createRandomTile(tiles)];\r\n    tilesCount--;\r\n  }\r\n\r\n  return tiles;\r\n};\r\n\r\nexport const createRandomTile = (tiles: Tile[]): Tile => {\r\n  const getCoordinates = (position: number): [number, number] => {\r\n    const x = Math.floor(position / 4);\r\n    const y = position % 4;\r\n    return [x, y];\r\n  };\r\n\r\n  Math.floor(Math.random() * 16);\r\n\r\n  let position = Math.floor(Math.random() * 16);\r\n  let coordinates = getCoordinates(position);\r\n  while (isExists(tiles, ...coordinates)) {\r\n    position = position === 15 ? 0 : position + 1;\r\n    coordinates = getCoordinates(position);\r\n  }\r\n\r\n  const value: Value = Math.random() <= 0.2 ? 4 : 2;\r\n\r\n  return {\r\n    id: getNextId(tiles),\r\n    value,\r\n    type: \"new\",\r\n    positionX: coordinates[0],\r\n    positionY: coordinates[1],\r\n  };\r\n};\r\n\r\nconst isExists = (\r\n  tiles: Tile[],\r\n  positionX: number,\r\n  positionY: number\r\n): boolean => {\r\n  return tiles.some(\r\n    (x) => x.positionX === positionX && x.positionY === positionY\r\n  );\r\n};\r\n\r\nexport const getRow = (tiles: Tile[], row: number): Array<Tile> =>\r\n  tiles.filter((x) => x.positionX === row);\r\n\r\nexport const getColumn = (tiles: Tile[], column: number): Array<Tile> =>\r\n  tiles.filter((x) => x.positionY === column);\r\n\r\nexport const getNextId = (tiles: Tile[]): number => {\r\n  return getMaxId(tiles) + 1;\r\n};\r\n\r\n// Returns the maximum id of the given tiles.\r\nexport const getMaxId = (tiles: Tile[]): number => {\r\n  return Math.max.apply(Math, [0, ...tiles.map((x) => x.id)]);\r\n};\r\n\r\nexport const MOVES_MAP: {[key: string]: Function } = {\r\n  \"up\": moveUp,\r\n  \"down\": moveDown,\r\n  \"right\": moveRight,\r\n  \"left\": moveLeft,\r\n};\r\n","import { Direction, TransformFactor } from \"../components/Interfaces\";\r\n\r\n/*\r\nSize XS screen: Up to 420 pixels\r\nSize S screen: Between 421 pixels and 520 pixels\r\n*/\r\nexport const ScreenSizeBreakpoint = {\r\n  XS: 420,\r\n  S: 520,\r\n};\r\n\r\n/*\r\nTiles XS Translation Factor: translates with factor 72.6\r\nTiles S Translation Factor: translates with factor 96.8\r\nTiles M Translation Factor: translates with factor 121\r\n*/\r\nexport const TilesScreenTransformFactor: { [key: string]: TransformFactor } = {\r\n  XS: 73,\r\n  S: 97,\r\n  M: 121,\r\n};\r\n\r\nexport const KEYBOARD_ARROW_TO_DIRECTION_MAP: { [key: string]: Direction } = {\r\n  ArrowUp: \"up\",\r\n  ArrowDown: \"down\",\r\n  ArrowRight: \"right\",\r\n  ArrowLeft: \"left\",\r\n};\r\n","import React, { memo } from \"react\";\r\nimport { TileType, Value } from \"../Interfaces\";\r\n\r\nimport \"./Tile.scss\";\r\n\r\ninterface TileProps {\r\n  value: Value;\r\n  type: TileType\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\nconst Tile = memo((props: TileProps) => {\r\n\r\n  return (\r\n    <div\r\n      className={`tile tile-${props.value}`}\r\n      style={{ transform: `translate(${props.x}px, ${props.y}px)` }}\r\n    >\r\n      <div className={`tileInner ${props.type}`}>{props.value}</div>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default Tile;","import React, { useEffect, useState } from \"react\";\r\nimport { ScreenSizeBreakpoint, TilesScreenTransformFactor } from \"../../constants/constants\";\r\nimport { Tile, TransformFactor } from \"../Interfaces\";\r\nimport {default as BoardTile} from \"./Tile\";\r\n\r\nimport \"./TilesList.scss\";\r\n\r\nconst TilesList = (props: { tiles: Tile[], factor: number }) => {\r\n  return (\r\n    <div>\r\n      {props.tiles.map((x) => (\r\n        <BoardTile\r\n          key={x.id}\r\n          value={x.value}\r\n          type={x.type}\r\n          x={x.positionY * props.factor}\r\n          y={x.positionX * props.factor}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const TileContainer = (props: { tiles: Tile[] }) => {\r\n\r\n  const [factor, setFactor] = useState<TransformFactor>(calcFactor());\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setFactor(calcFactor());\r\n    };\r\n\r\n    window.addEventListener(\"resize\", handleResize);\r\n\r\n    return () => window.removeEventListener(\"resize\", handleResize);\r\n  }, []);\r\n\r\n  const sortedTiles = props.tiles.sort((t1, t2) => t1.id - t2.id);\r\n  return (\r\n    <div className=\"tileContainer\">\r\n      <TilesList tiles={sortedTiles} factor={factor}/>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst calcFactor = () => {\r\n  if (window.innerWidth <= ScreenSizeBreakpoint.XS) {\r\n    return TilesScreenTransformFactor.XS;\r\n  }\r\n  if (window.innerWidth <= ScreenSizeBreakpoint.S) {\r\n    return TilesScreenTransformFactor.S;\r\n  }\r\n\r\n  return TilesScreenTransformFactor.M;\r\n};","import React from \"react\";\r\n\r\nimport \"./Button.scss\"\r\n\r\ninterface ButtonProps {\r\n  id?: string;\r\n  children: React.ReactNode;\r\n  onClick: (event: React.MouseEvent<HTMLButtonElement>) => void;\r\n}\r\n\r\nexport const Button = (props: ButtonProps) => {\r\n  return (\r\n    <button id={props.id} className=\"appButton\" onClick={props.onClick}>\r\n      {props.children}\r\n    </button>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport Button from \"../Button\";\r\nimport { useGameContext } from \"../Game\";\r\n\r\nconst DATA = {\r\n  \"WIN\": {\r\n    message: \"Congratulations! You Win!\",\r\n    buttonText: \"Play again\",\r\n    containerClass: \"gameResultWin\"\r\n  },\r\n  \"LOSE\": {\r\n    message: \"Game Over!\",\r\n    buttonText: \"Try again\",\r\n    containerClass: \"gameResultLose\"\r\n  }\r\n}\r\n\r\nconst GameResult = (props: {isWon: boolean}) => {\r\n  const { dispatch } = useGameContext();\r\n\r\n  const {message, buttonText, containerClass} = props.isWon ? DATA.WIN : DATA.LOSE;\r\n\r\n  return (\r\n    <div className={`gameResult ${containerClass}`}>\r\n      <p>{message}</p>\r\n      <Button onClick={(_) => dispatch({ type: \"restart\" })}>{buttonText}</Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameResult;","import React from \"react\";\r\nimport { isGameOver, isGameWon } from \"../../utils/gameUtils\";\r\nimport { Tile } from \"../Interfaces\";\r\nimport Tiles from \"../Tiles\";\r\nimport GameResult from \"./GameResult\";\r\nimport { GameStatus } from \"./Interfaces\";\r\n\r\nconst getGameStatus = (tiles: Tile[]): GameStatus => {\r\n  if (isGameWon(tiles)) {\r\n    return \"WIN\";\r\n  }\r\n  if (isGameOver(tiles)) {\r\n    return \"GAME_OVER\";\r\n  }\r\n\r\n  return \"IN_PROGRESS\";\r\n};\r\n\r\nconst BoardGrid = () => {\r\n  const grid = Array.from(Array(4).keys()).map((rowId) => {\r\n    const columns = Array.from(Array(4).keys()).map((colId) => (\r\n      <div key={colId} className=\"cell\"></div>\r\n    ));\r\n    return (\r\n      <div key={rowId} className=\"row\">\r\n        {columns}\r\n      </div>\r\n    );\r\n  });\r\n\r\n  return <div className=\"gridContainer\">{grid}</div>;\r\n};\r\n\r\nconst Board = (props: { tiles: Tile[] }) => {\r\n  const status = getGameStatus(props.tiles);\r\n\r\n  return (\r\n    <div id=\"boardContainer\">\r\n      {status !== \"IN_PROGRESS\" && <GameResult isWon={status === \"WIN\"} />}\r\n      <BoardGrid />\r\n      <Tiles tiles={props.tiles} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Board;\r\n","import React, { useEffect, useReducer } from \"react\";\r\nimport { MOVES_MAP } from \"../../utils/gameUtils\";\r\nimport { useGameContext } from \"../Game/Game\";\r\nimport { GameState } from \"../Interfaces\";\r\nimport Board from \"./Board\";\r\n\r\nimport \"./Board.scss\";\r\nimport { BoardActionType, BoardState } from \"./Interfaces\";\r\n\r\nexport const BoardProvider = () => {\r\n  const { gameState } = useGameContext();\r\n\r\n  const [boardState, dispatch] = useReducer(boardReducer, initState());\r\n  \r\n  useEffect(() => {\r\n    dispatch({ type: \"addMove\", payload: gameState });\r\n  }, [gameState]);\r\n\r\n  useEffect(() => {\r\n    if (boardState.moves.length < 2 || boardState.loading) {\r\n      return;\r\n    }\r\n\r\n    dispatch({ type: \"startMove\" });\r\n\r\n    setTimeout(() => {\r\n      dispatch({\r\n        type: \"endMove\",\r\n      });\r\n    }, 100);\r\n\r\n  }, [boardState]);\r\n\r\n  return <Board tiles={boardState.tiles} />;\r\n};\r\n\r\nfunction boardReducer(state: BoardState, action: BoardActionType): BoardState {\r\n  switch (action.type) {\r\n    case \"addMove\": {\r\n      const isNewGame = !action.payload.lastMove;\r\n      if (isNewGame || state.tiles.length === 0) {\r\n        return initState(action.payload);\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        moves: [...state.moves, action.payload],\r\n      };\r\n    }\r\n    case \"startMove\": {\r\n      const currGameState = state.moves[0];\r\n      const nextGameState = state.moves[1];\r\n      const tiles = MOVES_MAP[nextGameState.lastMove](currGameState.tiles);\r\n\r\n      return { ...state, loading: true, tiles };\r\n    }\r\n    case \"endMove\": {\r\n      const nextGameState = state.moves[1];\r\n      return {\r\n        moves: state.moves.slice(1),\r\n        loading: false,\r\n        tiles: nextGameState.tiles,\r\n      };\r\n    }\r\n    default: {\r\n      throw new Error(`Unhandled action: ${action}`);\r\n    }\r\n  }\r\n}\r\n\r\nconst initState = (gameState?: GameState): BoardState => {\r\n  if (gameState) {\r\n    return { moves: [gameState], loading: false, tiles: gameState.tiles };\r\n  }\r\n  return { moves: [], loading: false, tiles: [] };\r\n};\r\n","import React, { useEffect } from \"react\";\r\nimport { useGameContext } from \"../Game\";\r\nimport { BoardProvider } from \"./BoardProvider\";\r\n\r\nlet startClientX = null;\r\nlet startClientY = null;\r\n\r\nexport const BoardContainer = () => {\r\n  const { dispatch } = useGameContext();\r\n\r\n  useEffect(() => {\r\n    function handleTouchStart(event) {\r\n      if (event.touches.length === 1) {\r\n        const startTouch = event.touches[0];\r\n        startClientX = startTouch.clientX;\r\n        startClientY = startTouch.clientY;\r\n      }\r\n    }\r\n\r\n    function handleTouchEnd(event) {\r\n      if (!startClientX || !startClientY || event.touches.length > 0) {\r\n        return;\r\n      }\r\n    \r\n      const endTouch = event.changedTouches[0];\r\n      var endClientX = endTouch.clientX;\r\n      var endClientY = endTouch.clientY;\r\n    \r\n      var xDiff = startClientX - endClientX;\r\n      var yDiff = startClientY - endClientY;\r\n    \r\n      if (Math.abs(xDiff) > Math.abs(yDiff)) {\r\n        if (xDiff < 0) {\r\n          /* right swipe */\r\n          dispatch({ type: \"move\", payload: \"right\" });\r\n        } else {\r\n          /* left swipe */\r\n          dispatch({ type: \"move\", payload: \"left\" });\r\n        }\r\n      } else {\r\n        if (yDiff < 0) {\r\n          /* down swipe */\r\n          dispatch({ type: \"move\", payload: \"down\" });\r\n        } else {\r\n          /* up swipe */\r\n          dispatch({ type: \"move\", payload: \"up\" });\r\n        }\r\n      }\r\n      /* reset values */\r\n      startClientX = null;\r\n      startClientY = null;\r\n    }\r\n\r\n    const boardContainer = document.getElementById(\"boardContainer\");\r\n    boardContainer.addEventListener(\"touchstart\", handleTouchStart);\r\n    boardContainer.addEventListener('touchend', handleTouchEnd);\r\n\r\n    return () => {\r\n      boardContainer.removeEventListener(\"touchstart\", handleTouchStart);\r\n      boardContainer.removeEventListener(\"touchend\", handleTouchEnd);\r\n    };\r\n  }, [dispatch]);\r\n\r\n  return <BoardProvider />;\r\n};\r\n","import { useEffect, useReducer } from \"react\";\r\n\r\nconst GAME_ID = \"2048game\";\r\n\r\nconst useStateReducer = (prevState, newState) => {\r\n  return typeof newState === \"function\" ? newState(prevState) : newState;\r\n};\r\n\r\nconst getInitialValue = (key: string, defaultValue: any) => {\r\n  try {\r\n    const gameState = JSON.parse(window.localStorage.getItem(GAME_ID));\r\n    const value = gameState?.[key];\r\n    return value ?? defaultValue;\r\n  } catch (error) {\r\n    console.log(error);\r\n    return defaultValue;\r\n  }\r\n};\r\n\r\nfunction useGameLocalStorage<T>(\r\n  key: string,\r\n  defaultValue: T,\r\n  reducer = useStateReducer\r\n) {\r\n  const [value, dispatch] = useReducer(\r\n    reducer,\r\n    getInitialValue(key, defaultValue)\r\n  );\r\n\r\n  useEffect(() => {\r\n    let state = JSON.parse(window.localStorage.getItem(GAME_ID)) || {};\r\n    state[key] = value;\r\n    window.localStorage.setItem(GAME_ID, JSON.stringify(state));\r\n  }, [value, key]);\r\n\r\n  return [value, dispatch];\r\n}\r\n\r\nexport default useGameLocalStorage;\r\n","import React from \"react\";\r\n\r\nimport \"./ScoreBox.scss\";\r\n\r\ninterface ScoreBoxProps {\r\n  title: string;\r\n  score: number;\r\n}\r\n\r\nexport const ScoreBox = (props: ScoreBoxProps) => {\r\n  return <div className=\"scoreBox\">\r\n    <span className=\"title\">{props.title}</span>\r\n    <span className=\"score\">{props.score}</span>\r\n  </div>\r\n}\r\n\r\n","import React, { useEffect } from \"react\";\r\nimport useGameLocalStorage from \"../../hooks/useLocalStorage\";\r\nimport { getMaxId } from \"../../utils/gameUtils\";\r\nimport { useGameContext } from \"../Game/Game\";\r\nimport { Tile } from \"../Interfaces\";\r\nimport ScoreBox from \"../ScoreBox\";\r\nimport { ACTIONTYPE, ScoresState } from \"./Interfaces\";\r\n\r\nimport \"./ScoresContainer.scss\";\r\n\r\nexport const ScoresContainer = () => {\r\n  const { gameState } = useGameContext();\r\n\r\n  const [state, dispatch] = useGameLocalStorage(\r\n    \"scores\",\r\n    initState(),\r\n    stateReducer\r\n  );\r\n\r\n  useEffect(() => {\r\n    dispatch({ type: \"change\", payload: gameState.tiles });\r\n  }, [gameState.tiles, dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (state.newPoints > 0) {\r\n      const oldAddScore = document.getElementById(\"additionScore\");\r\n      oldAddScore.innerText = `+${state.newPoints}`;\r\n      const newAddScore = oldAddScore.cloneNode(true);\r\n      oldAddScore.parentNode.replaceChild(newAddScore, oldAddScore);\r\n    }\r\n  }, [state]);\r\n\r\n  return (\r\n    <div className=\"scoresContainer\">\r\n      <div style={{ position: \"relative\" }}>\r\n        <ScoreBox title=\"SCORE\" score={state.score} />\r\n        <div className=\"addScore\" id=\"additionScore\"></div>\r\n      </div>\r\n\r\n      <ScoreBox title=\"BEST\" score={state.bestScore} />\r\n    </div>\r\n  );\r\n};\r\n\r\nconst initState = (tiles: Tile[] = []): ScoresState => {\r\n  return {\r\n    score: 0,\r\n    newPoints: 0,\r\n    bestScore: 0,\r\n    tiles,\r\n  };\r\n};\r\n\r\nconst containsTile = (tiles: Tile[], tile: Tile): boolean => {\r\n  return tiles.some((t) => t.id === tile.id);\r\n};\r\n\r\nconst stateReducer = (state: ScoresState, action: ACTIONTYPE) => {\r\n  switch (action.type) {\r\n    case \"change\": {\r\n      const tiles = action.payload;\r\n\r\n      // handles page refresh\r\n      if (\r\n        state.tiles.length === tiles.length &&\r\n        state.tiles.every((t) => containsTile(tiles, t))\r\n      ) {\r\n        return state;\r\n      }\r\n\r\n      // handles restart\r\n      if (\r\n        tiles.length === 2 &&\r\n        [1, 2].every((id) => tiles.find((tile) => tile.id === id)) &&\r\n        !state.tiles.every((t) => containsTile(tiles, t))\r\n      ) {\r\n        return { ...initState(tiles), bestScore: state.bestScore };\r\n      }\r\n\r\n      // handles add new tile\r\n      if (\r\n        state.tiles.every((t) => containsTile(tiles, t)) &&\r\n        tiles.length === state.tiles.length + 1\r\n      ) {\r\n        return { ...state, tiles: tiles, newPoints: 0 };\r\n      }\r\n\r\n      // handles merge\r\n      const lastGeneratedTileId = getMaxId(tiles);\r\n      const newPoints = tiles.reduce((acc: number, curr: Tile) => {\r\n        const add =\r\n          curr.id === lastGeneratedTileId || containsTile(state.tiles, curr)\r\n            ? 0\r\n            : curr.value;\r\n        return acc + add;\r\n      }, 0);\r\n\r\n      const score = state.score + newPoints;\r\n      const bestScore = Math.max(score, state.bestScore);\r\n\r\n      return { tiles, newPoints, score, bestScore };\r\n    }\r\n    default: {\r\n      throw new Error(`Unhandled action type: ${action.type}`);\r\n    }\r\n  }\r\n};\r\n","import React from \"react\";\r\nimport Button from \"../Button\";\r\nimport { useGameContext } from \"../Game\";\r\nimport ScoresContainer from \"../ScoresContainer\";\r\n\r\nimport \"./GameHeader.scss\";\r\n\r\nconst GameTitle = () => <span className=\"gameTitle\">2048</span>;\r\n\r\nconst GameDescription = () => {\r\n  return (\r\n    <div>\r\n      <span>Join the numbers to get <b>2048</b>!</span>\r\n      <br />\r\n      <a href=\"#howToPlaySection\">How to play →</a>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const GameHeader = () => {\r\n  const { dispatch } = useGameContext();\r\n\r\n  return (\r\n    <div className=\"header\">\r\n      <div className=\"gameIntro\">\r\n        <GameTitle />\r\n        <GameDescription />\r\n      </div>\r\n      <div className=\"actions\">\r\n        <ScoresContainer />\r\n        <Button\r\n          id=\"restartGameBtn\"\r\n          onClick={(_) => dispatch({ type: \"restart\" })}\r\n        >\r\n          New Game\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { SectionProps } from \"./Interfaces\";\r\n\r\nconst Section = (props: SectionProps) => {\r\n  return (\r\n    <div id={props.id}>\r\n      <h4>{props.title}</h4>\r\n      {props.children}\r\n      {props.bottomSeparator ? <hr /> : null}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst GameRules = (props: { bottomSeparator?: boolean }) => {\r\n  return (\r\n    <Section\r\n      id=\"howToPlaySection\"\r\n      title=\"HOW TO PLAY\"\r\n      bottomSeparator={props.bottomSeparator}\r\n    >\r\n      <p>\r\n        Use your arrow keys to move the numbers. The same numbers will be merged\r\n        into one when they touch. After each move, a new number (\r\n        <strong>2</strong> or <strong>4</strong>) is generated at a random empty\r\n        position. Merge the numbers and build a 2048 number to{\" \"}\r\n        <strong>WIN</strong> the game!\r\n      </p>\r\n    </Section>\r\n  );\r\n};\r\n\r\nconst LearnMore = (props: { bottomSeparator?: boolean }) => {\r\n  return (\r\n    <Section title=\"LEARN MORE\" bottomSeparator={props.bottomSeparator}>\r\n      <p>\r\n        This app is inspired by{\" \"}\r\n        <a href=\"https://play2048.co/\">https://play2048.co/</a>. If you want to\r\n        learn more about the project tech stack or see the code, visit the&nbsp;\r\n        <a\r\n          href=\"https://github.com/grigorzyapkov/2048game\"\r\n          target=\"_blank\"\r\n          rel=\"noreferrer\"\r\n        >\r\n          Github repository\r\n        </a>\r\n        .\r\n      </p>\r\n    </Section>\r\n  );\r\n};\r\n\r\nexport const GameFooter = () => {\r\n  return (\r\n    <div>\r\n      <GameRules />\r\n      <hr />\r\n      <LearnMore />\r\n    </div>\r\n  );\r\n};\r\n","import React, { useContext, useEffect } from \"react\";\r\nimport Board from \"../Board\";\r\n\r\nimport \"./Game.scss\";\r\nimport {\r\n  areEqual,\r\n  createRandomTile,\r\n  generateBoard,\r\n  merge,\r\n  MOVES_MAP,\r\n} from \"../../utils/gameUtils\";\r\nimport GameHeader from \"../GameHeader\";\r\nimport {\r\n  GameContextActionType,\r\n  GameState,\r\n  IGameContext,\r\n  Direction,\r\n  Tile,\r\n} from \"../Interfaces\";\r\nimport GameFooter from \"../GameFooter\";\r\nimport useGameLocalStorage from \"../../hooks/useLocalStorage\";\r\nimport { KEYBOARD_ARROW_TO_DIRECTION_MAP } from \"../../constants/constants\";\r\n\r\nconst GameContext = React.createContext<IGameContext>(null);\r\n\r\nconst initState = (tilesCount = 2): GameState => {\r\n  return {\r\n    tiles: generateBoard(tilesCount),\r\n    lastMove: null,\r\n  };\r\n};\r\n\r\nfunction gameReducer(state: GameState, action: GameContextActionType) {\r\n  switch (action.type) {\r\n    case \"restart\": {\r\n      return initState();\r\n    }\r\n    case \"move\": {\r\n      const move = MOVES_MAP[action.payload];\r\n      let tiles: Tile[] = move(state.tiles);\r\n      if (areEqual(state.tiles, tiles)) {\r\n        return state;\r\n      }\r\n\r\n      tiles = merge(tiles);\r\n      return {\r\n        tiles: [...tiles, createRandomTile(tiles)],\r\n        lastMove: action.payload,\r\n      };\r\n    }\r\n    default: {\r\n      throw new Error(`Unhandled action: ${action}`);\r\n    }\r\n  }\r\n}\r\n\r\nconst GameProvider = (props) => {\r\n  const [state, dispatch] = useGameLocalStorage(\r\n    \"game\",\r\n    initState(),\r\n    gameReducer\r\n  );\r\n  console.log(\"GameProvider\");\r\n\r\n  useEffect(() => {\r\n    const handleKeyPress = (e: KeyboardEvent) => {\r\n      e.preventDefault();\r\n      const direction: Direction | undefined =\r\n        KEYBOARD_ARROW_TO_DIRECTION_MAP[e.key];\r\n      if (direction) {\r\n        dispatch({ type: \"move\", payload: direction });\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"keydown\", handleKeyPress);\r\n\r\n    return () => {\r\n      document.removeEventListener(\"keydown\", handleKeyPress);\r\n    };\r\n  }, [dispatch]);\r\n\r\n  return (\r\n    <GameContext.Provider value={{ gameState: state, dispatch }}>\r\n      {props.children}\r\n    </GameContext.Provider>\r\n  );\r\n};\r\n\r\nconst Game = () => {\r\n  return (\r\n    <GameProvider>\r\n      <div className=\"container\">\r\n        <div className=\"gameContainer\">\r\n          <GameHeader />\r\n          <Board />\r\n        </div>\r\n        <GameFooter />\r\n      </div>\r\n    </GameProvider>\r\n  );\r\n};\r\n\r\nfunction useGameContext() {\r\n  const context = useContext(GameContext);\r\n  if (context === undefined) {\r\n    throw new Error(\"useGameContext must be used within a GameContextProvider\");\r\n  }\r\n  return context;\r\n}\r\n\r\nexport { Game, useGameContext };\r\n","import React from 'react';\nimport './App.scss';\nimport Game from '../Game';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <main>\n        <Game />\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './components/App/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}