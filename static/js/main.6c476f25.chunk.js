(this.webpackJsonp2048game=this.webpackJsonp2048game||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),c=n(8),i=n.n(c),a=(n(13),n(14),n(3)),s=n(4),u=n(2),l=[0,1,2,3],d=function(e,t){var n,r;return null===e&&null===t||(e&&(null===(n=Object.keys(e))||void 0===n?void 0:n.length))===(t&&(null===(r=Object.keys(t))||void 0===r?void 0:r.length))&&Object.keys(e).every((function(n){return e[n]===t[n]}))},f=function(e,t){return v(e,(function(e){return e.positionY}),(function(e,t){return e.positionY=t}),t)},j=function(e,t){return v(e,(function(e){return e.positionX}),(function(e,t){return e.positionX=t}),t)},v=function(e,t,n,r){if(0===e.length)return[];var o=JSON.parse(JSON.stringify(e));o.sort((function(e,n){return t(e)-t(n)}));for(var c="left"===r?0:4-o.length,i=0;i<o.length;i++)n(o[i],c+i);"left"===r&&o.reverse();for(var a=o.length-1;a>=1;)if(o[a].value!==o[a-1].value||2048===o[a].value)a--;else{for(var s=0;s<=a-1;s++){var u="right"===r?1:-1;n(o[s],t(o[s])+u)}a-=2}return o},h=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=[];e>0;)t=[].concat(Object(s.a)(t),[b(t)]),e--;return t},b=function(e){var t=function(e){return[Math.floor(e/4),e%4]};Math.floor(16*Math.random());for(var n=Math.floor(16*Math.random()),r=t(n);m.apply(void 0,[e].concat(Object(s.a)(r)));)r=t(n=15===n?0:n+1);var o=Math.random()<=.2?4:2;return{id:g(e),value:o,type:"new",positionX:r[0],positionY:r[1]}},m=function(e,t,n){return e.some((function(e){return e.positionX===t&&e.positionY===n}))},O=function(e,t){return e.filter((function(e){return e.positionX===t}))},p=function(e,t){return e.filter((function(e){return e.positionY===t}))},g=function(e){return x(e)+1},x=function(e){return Math.max.apply(Math,[0].concat(Object(s.a)(e.map((function(e){return e.id})))))},y={up:function(e){return l.map((function(t){return j(p(e,t),"left")})).flat()},down:function(e){return l.map((function(t){return j(p(e,t),"right")})).flat()},right:function(e){return l.map((function(t){return f(O(e,t),"right")})).flat()},left:function(e){return l.map((function(t){return f(O(e,t),"left")})).flat()}},w=420,S=520,N=73,E=97,M=121,C={ArrowUp:"up",ArrowDown:"down",ArrowRight:"right",ArrowLeft:"left"},k=(n(15),n(0)),I=Object(r.memo)((function(e){return Object(k.jsx)("div",{className:"tile tile-".concat(e.value),style:{transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)")},children:Object(k.jsx)("div",{className:"tileInner ".concat(e.type),children:e.value})})})),L=(n(17),function(e){return Object(k.jsx)("div",{children:e.tiles.map((function(t){return Object(k.jsx)(I,{value:t.value,type:t.type,x:t.positionY*e.factor,y:t.positionX*e.factor},t.id)}))})}),P=function(e){var t=Object(r.useState)(T()),n=Object(a.a)(t,2),o=n[0],c=n[1];Object(r.useEffect)((function(){var e=function(){c(T())};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var i=e.tiles.sort((function(e,t){return e.id-t.id}));return Object(k.jsx)("div",{className:"tileContainer",children:Object(k.jsx)(L,{tiles:i,factor:o})})},T=function(){return window.innerWidth<=w?N:window.innerWidth<=S?E:M},R=(n(18),function(e){return Object(k.jsx)("button",{id:e.id,className:"appButton",onClick:e.onClick,children:e.children})}),A={WIN:{message:"Congratulations! You Win!",buttonText:"Play again",containerClass:"gameResultWin"},LOSE:{message:"Game Over!",buttonText:"Try again",containerClass:"gameResultLose"}},W=function(e){var t=je().dispatch,n=e.isWon?A.WIN:A.LOSE,r=n.message,o=n.buttonText,c=n.containerClass;return Object(k.jsxs)("div",{className:"gameResult ".concat(c),children:[Object(k.jsx)("p",{children:r}),Object(k.jsx)(R,{onClick:function(e){return t({type:"restart"})},children:o})]})},Y=function(e){return function(e){return e.some((function(e){return 2048===e.value}))}(e)?"WIN":function(e){if(e.length<16)return!1;for(var t=function(e,t,n){return e.some((function(e){return t.some((function(t){return n(e)===n(t)&&e.value===t.value}))}))},n=0;n<3;n++)if(t(O(e,n),O(e,n+1),(function(e){return e.positionY}))||t(p(e,n),p(e,n+1),(function(e){return e.positionX})))return!1;return!0}(e)?"GAME_OVER":"IN_PROGRESS"},G=function(){var e=Array.from(Array(4).keys()).map((function(e){var t=Array.from(Array(4).keys()).map((function(e){return Object(k.jsx)("div",{className:"cell"},e)}));return Object(k.jsx)("div",{className:"row",children:t},e)}));return Object(k.jsx)("div",{className:"gridContainer",children:e})},X=function(e){var t=Y(e.tiles);return Object(k.jsxs)("div",{id:"boardContainer",children:["IN_PROGRESS"!==t&&Object(k.jsx)(W,{isWon:"WIN"===t}),Object(k.jsx)(G,{}),Object(k.jsx)(P,{tiles:e.tiles})]})},B=(n(19),function(){var e=je().gameState,t=Object(r.useReducer)(J,U()),n=Object(a.a)(t,2),o=n[0],c=n[1];return Object(r.useEffect)((function(){c({type:"addMove",payload:e})}),[e]),Object(r.useEffect)((function(){o.moves.length<2||o.loading||(c({type:"startMove"}),setTimeout((function(){c({type:"endMove"})}),100))}),[o]),Object(k.jsx)(X,{tiles:o.tiles})});function J(e,t){switch(t.type){case"addMove":return!t.payload.lastMove||0===e.tiles.length?U(t.payload):Object(u.a)(Object(u.a)({},e),{},{moves:[].concat(Object(s.a)(e.moves),[t.payload])});case"startMove":var n=e.moves[0],r=e.moves[1],o=y[r.lastMove](n.tiles);return Object(u.a)(Object(u.a)({},e),{},{loading:!0,tiles:o});case"endMove":var c=e.moves[1];return{moves:e.moves.slice(1),loading:!1,tiles:c.tiles};default:throw new Error("Unhandled action: ".concat(t))}}var U=function(e){return e?{moves:[e],loading:!1,tiles:e.tiles}:{moves:[],loading:!1,tiles:[]}},F=null,_=null,z=function(){var e=je().dispatch;return Object(r.useEffect)((function(){function t(e){if(1===e.touches.length){var t=e.touches[0];F=t.clientX,_=t.clientY}}function n(t){if(F&&_&&!(t.touches.length>0)){var n=t.changedTouches[0],r=n.clientX,o=n.clientY,c=F-r,i=_-o;Math.abs(c)>Math.abs(i)?e(c<0?{type:"move",payload:"right"}:{type:"move",payload:"left"}):e(i<0?{type:"move",payload:"down"}:{type:"move",payload:"up"}),F=null,_=null}}var r=document.getElementById("boardContainer");return r.addEventListener("touchstart",t),r.addEventListener("touchend",n),function(){r.removeEventListener("touchstart",t),r.removeEventListener("touchend",n)}}),[e]),Object(k.jsx)(B,{})},D=(n(20),"2048game"),H=function(e,t){return"function"===typeof t?t(e):t},V=function(e,t){try{var n=JSON.parse(window.localStorage.getItem(D)),r=null===n||void 0===n?void 0:n[e];return null!==r&&void 0!==r?r:t}catch(o){return console.log(o),t}};var q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:H,o=Object(r.useReducer)(n,V(e,t)),c=Object(a.a)(o,2),i=c[0],s=c[1];return Object(r.useEffect)((function(){var t=JSON.parse(window.localStorage.getItem(D))||{};t[e]=i,window.localStorage.setItem(D,JSON.stringify(t))}),[i,e]),[i,s]},K=(n(21),function(e){return Object(k.jsxs)("div",{className:"scoreBox",children:[Object(k.jsx)("span",{className:"title",children:e.title}),Object(k.jsx)("span",{className:"score",children:e.score})]})}),Q=(n(22),function(){var e=je().gameState,t=q("scores",Z(),ee),n=Object(a.a)(t,2),o=n[0],c=n[1];return Object(r.useEffect)((function(){c({type:"change",payload:e.tiles})}),[e.tiles,c]),Object(r.useEffect)((function(){if(o.newPoints>0){var e=document.getElementById("additionScore");e.innerText="+".concat(o.newPoints);var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)}}),[o]),Object(k.jsxs)("div",{className:"scoresContainer",children:[Object(k.jsxs)("div",{style:{position:"relative"},children:[Object(k.jsx)(K,{title:"SCORE",score:o.score}),Object(k.jsx)("div",{className:"addScore",id:"additionScore"})]}),Object(k.jsx)(K,{title:"BEST",score:o.bestScore})]})}),Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{score:0,newPoints:0,bestScore:0,tiles:e}},$=function(e,t){return e.some((function(e){return e.id===t.id}))},ee=function(e,t){switch(t.type){case"change":var n=t.payload;if(e.tiles.length===n.length&&e.tiles.every((function(e){return $(n,e)})))return e;if(2===n.length&&[1,2].every((function(e){return n.find((function(t){return t.id===e}))}))&&!e.tiles.every((function(e){return $(n,e)})))return Object(u.a)(Object(u.a)({},Z(n)),{},{bestScore:e.bestScore});if(e.tiles.every((function(e){return $(n,e)}))&&n.length===e.tiles.length+1)return Object(u.a)(Object(u.a)({},e),{},{tiles:n,newPoints:0});var r=x(n),o=n.reduce((function(t,n){return t+(n.id===r||$(e.tiles,n)?0:n.value)}),0),c=e.score+o,i=Math.max(c,e.bestScore);return{tiles:n,newPoints:o,score:c,bestScore:i};default:throw new Error("Unhandled action type: ".concat(t.type))}},te=(n(23),function(){return Object(k.jsx)("span",{className:"gameTitle",children:"2048"})}),ne=function(){return Object(k.jsxs)("div",{children:[Object(k.jsxs)("span",{children:["Join the numbers to get ",Object(k.jsx)("b",{children:"2048"}),"!"]}),Object(k.jsx)("br",{}),Object(k.jsx)("a",{href:"#howToPlaySection",children:"How to play \u2192"})]})},re=function(){var e=je().dispatch;return Object(k.jsxs)("div",{className:"header",children:[Object(k.jsxs)("div",{className:"gameIntro",children:[Object(k.jsx)(te,{}),Object(k.jsx)(ne,{})]}),Object(k.jsxs)("div",{className:"actions",children:[Object(k.jsx)(Q,{}),Object(k.jsx)(R,{id:"restartGameBtn",onClick:function(t){return e({type:"restart"})},children:"New Game"})]})]})},oe=function(e){return Object(k.jsxs)("div",{id:e.id,children:[Object(k.jsx)("h4",{children:e.title}),e.children,e.bottomSeparator?Object(k.jsx)("hr",{}):null]})},ce=function(e){return Object(k.jsx)(oe,{id:"howToPlaySection",title:"HOW TO PLAY",bottomSeparator:e.bottomSeparator,children:Object(k.jsxs)("p",{children:["Use your arrow keys to move the numbers. The same numbers will be merged into one when they touch. After each move, a new number (",Object(k.jsx)("strong",{children:"2"})," or ",Object(k.jsx)("strong",{children:"4"}),") is generated at a random empty position. Merge the numbers and build a 2048 number to"," ",Object(k.jsx)("strong",{children:"WIN"})," the game!"]})})},ie=function(e){return Object(k.jsx)(oe,{title:"LEARN MORE",bottomSeparator:e.bottomSeparator,children:Object(k.jsxs)("p",{children:["This app is inspired by"," ",Object(k.jsx)("a",{href:"https://play2048.co/",children:"https://play2048.co/"}),". If you want to learn more about the project tech stack or see the code, visit the\xa0",Object(k.jsx)("a",{href:"https://github.com/grigorzyapkov/2048game",target:"_blank",rel:"noreferrer",children:"Github repository"}),"."]})})},ae=function(){return Object(k.jsxs)("div",{children:[Object(k.jsx)(ce,{}),Object(k.jsx)("hr",{}),Object(k.jsx)(ie,{})]})},se=o.a.createContext(null),ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return{tiles:h(e),lastMove:null}};function le(e,t){switch(t.type){case"restart":return ue();case"move":var n=(0,y[t.payload])(e.tiles);return r=e.tiles,o=n,r.every((function(e){return o.some((function(t){return d(e,t)}))}))?e:(n=function(e){var t=g(e),n={};return e.forEach((function(e){var r="".concat(e.positionX).concat(e.positionY);if(n[r]){var o=2*e.value;n[r]=Object(u.a)(Object(u.a)({},e),{},{id:t++,value:o,type:"merged"})}else n[r]=e})),Object.values(n)}(n),{tiles:[].concat(Object(s.a)(n),[b(n)]),lastMove:t.payload});default:throw new Error("Unhandled action: ".concat(t))}var r,o}var de=function(e){var t=q("game",ue(),le),n=Object(a.a)(t,2),o=n[0],c=n[1];return console.log("GameProvider"),Object(r.useEffect)((function(){var e=function(e){e.preventDefault();var t=C[e.key];t&&c({type:"move",payload:t})};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[c]),Object(k.jsx)(se.Provider,{value:{gameState:o,dispatch:c},children:e.children})},fe=function(){return Object(k.jsx)(de,{children:Object(k.jsxs)("div",{className:"container",children:[Object(k.jsxs)("div",{className:"gameContainer",children:[Object(k.jsx)(re,{}),Object(k.jsx)(z,{})]}),Object(k.jsx)(ae,{})]})})};function je(){var e=Object(r.useContext)(se);if(void 0===e)throw new Error("useGameContext must be used within a GameContextProvider");return e}var ve=function(){return Object(k.jsx)("div",{className:"App",children:Object(k.jsx)("main",{children:Object(k.jsx)(fe,{})})})},he=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,25)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),o(e),c(e),i(e)}))};i.a.render(Object(k.jsx)(o.a.StrictMode,{children:Object(k.jsx)(ve,{})}),document.getElementById("root")),he()}],[[24,1,2]]]);
//# sourceMappingURL=main.6c476f25.chunk.js.map